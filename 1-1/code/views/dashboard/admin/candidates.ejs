<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<!-- Google Fonts -->
		<link
			href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
			crossorigin="anonymous"
		/>
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
			crossorigin="anonymous"
		></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		<link href="../css/style.css" rel="stylesheet" />
		<title>Admin</title>
		<script>
			$(document).ready(function () {
				$("#actionCandidateModal").on("show.bs.modal", function (e) {
					let data = {
						id: $(e.relatedTarget).attr("_id"),
						first_name: $(e.relatedTarget).attr("first_name"),
						last_name: $(e.relatedTarget).attr("last_name"),
						position: $(e.relatedTarget).attr("position"),
						political_party: $(e.relatedTarget).attr(
							"political_party"
						),
						image: $(e.relatedTarget).attr("image"),
					};
					if (data.id != undefined) {
						$("#modal-title").text("Edit Candidate");
						$("#modal-button").text("Update");
						$("#first_name").val(data.first_name);
						$("#last_name").val(data.last_name);
						$("#political_party").val(data.political_party);
						$("#position").val(data.position);
						$("#image").val(data.image);
						$("#form_modal").attr(
							"action",
							`/dashboard/update/${$(e.relatedTarget).attr(
								"_id"
							)}`
						);
					} else {
						$("#modal-title").text("Add Candidate");
						$("#modal-button").text("Add");
						$("#first_name").val("");
						$("#last_name").val("");
						$("#political_party").val("");
					}
				});
				$("#deleteCandidateModal").on("show.bs.modal", function (e) {
					let id = $(e.relatedTarget).attr("_id");
					$("#form_delete").attr(
						"action",
						`/dashboard/delete/${$(e.relatedTarget).attr("_id")}`
					);
				});
			});
		</script>
	</head>
	<body>
		<div class="container">
			<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
				<div class="container-fluid">
					<a class="navbar-brand" href="#">Admin</a>
					<button
						class="navbar-toggler"
						type="button"
						data-bs-toggle="collapse"
						data-bs-target="#navbarNavAltMarkup"
						aria-controls="navbarNavAltMarkup"
						aria-expanded="false"
						aria-label="Toggle navigation"
					>
						<span class="navbar-toggler-icon"></span>
					</button>
					<div
						class="collapse navbar-collapse"
						id="navbarNavAltMarkup"
					>
						<div class="navbar-nav">
							<a class="nav-link" aria-current="page" href="#"
								>Dashboard</a
							>
							<a
								class="nav-link active"
								href="/dashboard/candidates"
								>Candidates</a
							>
							<div class="navbar-nav">
								<a class="nav-link" href="/logoff">Logoff</a>
							</div>
						</div>
					</div>
				</div>
			</nav>
			<div class="content">
				<h2>Candidates</h2>
				<button
					type="button"
					class="btn btn-primary"
					data-bs-toggle="modal"
					data-bs-target="#actionCandidateModal"
				>
					Add Candidate
				</button>
				<h3>President</h3>
				<div class="row">
					<div class="col-auto">
						<table class="table">
							<tr>
								<th>Picture</th>
								<th>First Name</th>
								<th>Last Name</th>
								<th>Political Party</th>
								<th>Action</th>
							</tr>

							<% for(president of presidents) { %>
							<tr>
								<td>
									<img
										class="table_image"
										src="../images/<%= president.image %>"
									/>
								</td>
								<td><%= president.first_name %></td>
								<td><%= president.last_name %></td>
								<td><%= president.political_party %></td>
								<td>
									<button
										type="button"
										id="edit"
										class="btn btn-primary"
										data-bs-toggle="modal"
										data-bs-target="#actionCandidateModal"
										_id="<%= president._id %>"
										first_name="<%= president.first_name %>"
										last_name="<%= president.last_name %>"
										political_party="<%= president.political_party %>"
										position="<%= president.position %>"
										image="<%= president.image %>"
									>
										Edit
									</button>
									<button
										type="button"
										class="btn btn-danger"
										data-bs-toggle="modal"
										data-bs-target="#deleteCandidateModal"
										_id="<%= president._id %>"
									>
										Delete
									</button>
								</td>
							</tr>
							<% } %>
						</table>
					</div>
				</div>
				<h3>Vice President</h3>
				<div class="row">
					<div class="col-auto">
						<table class="table">
							<tr>
								<th>Picture</th>
								<th>First Name</th>
								<th>Last Name</th>
								<th>Political Party</th>
								<th>Action</th>
							</tr>
							<% for(vice_president of vice_presidents) { %>
							<tr>
								<td>
									<img
										class="table_image"
										src="../images/<%= vice_president.image %>"
									/>
								</td>
								<td><%= vice_president.first_name %></td>
								<td><%= vice_president.last_name %></td>
								<td><%= vice_president.political_party %></td>
								<td>
									<button
										type="button"
										id="edit"
										class="btn btn-primary"
										data-bs-toggle="modal"
										data-bs-target="#actionCandidateModal"
										_id="<%= vice_president._id %>"
										first_name="<%= vice_president.first_name %>"
										last_name="<%= vice_president.last_name %>"
										political_party="<%= vice_president.political_party %>"
										position="<%= vice_president.position %>"
										image="<%= vice_president.image %>"
									>
										Edit
									</button>
									<button
										type="button"
										class="btn btn-danger"
										data-bs-toggle="modal"
										data-bs-target="#deleteCandidateModal"
										_id="<%= vice_president._id %>"
									>
										Delete
									</button>
								</td>
							</tr>
							<% } %>
						</table>
					</div>
				</div>
				<h3>Senators</h3>
				<div class="row">
					<div class="col-auto">
						<table class="table">
							<tr>
								<th>Picture</th>
								<th>First Name</th>
								<th>Last Name</th>
								<th>Political Party</th>
								<th>Action</th>
							</tr>
							<% for(senator of senators) { %>
							<tr>
								<td>
									<img
										class="table_image"
										src="../images/<%= senator.image %>"
									/>
								</td>
								<td><%= senator.first_name %></td>
								<td><%= senator.last_name %></td>
								<td><%= senator.political_party %></td>
								<td>
									<button
										type="button"
										id="edit"
										class="btn btn-primary"
										data-bs-toggle="modal"
										data-bs-target="#actionCandidateModal"
										_id="<%= senator._id %>"
										first_name="<%= senator.first_name %>"
										last_name="<%= senator.last_name %>"
										political_party="<%= senator.political_party %>"
										position="<%= senator.position %>"
										image="<%= senator.image %>"
									>
										Edit
									</button>
									<button
										type="button"
										class="btn btn-danger"
										data-bs-toggle="modal"
										data-bs-target="#deleteCandidateModal"
										_id="<%= senator._id %>"
									>
										Delete
									</button>
								</td>
							</tr>
							<% } %>
						</table>
					</div>
				</div>
			</div>
		</div>
		<!-- Delete Modal -->
		<div
			class="modal fade"
			id="deleteCandidateModal"
			tabindex="-1"
			aria-labelledby="modal-title"
			aria-hidden="true"
		>
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="delete-modal-title">
							Delete Candidate
						</h5>
						<button
							type="button"
							class="btn-close"
							data-bs-dismiss="modal"
							aria-label="Close"
						></button>
					</div>
					<div class="modal-body">
						Are you sure you want to delete this Candidate?
					</div>
					<div class="modal-footer">
						<button
							type="button"
							class="btn btn-secondary"
							data-bs-dismiss="modal"
						>
							No
						</button>
						<form id="form_delete" method="post">
							<button type="submit" class="btn btn-danger">
								Yes
							</button>
						</form>
					</div>
				</div>
			</div>
		</div>
		<!-- Add/Edit Candidate Modal -->
		<div
			class="modal fade"
			id="actionCandidateModal"
			tabindex="-1"
			aria-labelledby="actionCandidateModal"
			aria-hidden="true"
		>
			<div class="modal-dialog">
				<div class="modal-content">
					<form
						action="/dashboard/candidates"
						method="post"
						enctype="multipart/form-data"
						id="form_modal"
					>
						<div class="modal-header">
							<h5 class="modal-title" id="modal-title">
								Add Candidate
							</h5>
							<button
								type="button"
								class="btn-close"
								data-bs-dismiss="modal"
								aria-label="Close"
							></button>
						</div>
						<div class="modal-body">
							<div class="form-outline mb-4">
								<label class="form-label">First Name</label>
								<input
									type="text"
									id="first_name"
									name="first_name"
									class="form-control form-control-lg"
								/>
							</div>
							<div class="form-outline mb-4">
								<label class="form-label">Last Name</label>
								<input
									type="text"
									id="last_name"
									name="last_name"
									class="form-control form-control-lg"
								/>
							</div>
							<div class="form-outline mb-4">
								<label class="form-label"
									>Political Party</label
								>
								<input
									type="text"
									id="political_party"
									name="political_party"
									class="form-control form-control-lg"
								/>
							</div>
							<div class="form-outline mb-4">
								<label class="form-label"
									>Position Running</label
								>
								<select
									class="form-control"
									name="position"
									id="position"
								>
									<option value="president">President</option>
									<option value="vice president">
										Vice President
									</option>
									<option value="senator">Senator</option>
								</select>
							</div>
							<div class="form-outline mb-4">
								<label for="formFile" class="form-label"
									>Candidate Image</label
								>
								<input
									class="form-control"
									type="file"
									id="candidate_image"
									name="candidate_image"
								/>
							</div>
						</div>
						<div class="modal-footer">
							<button
								type="button"
								class="btn btn-secondary"
								data-bs-dismiss="modal"
							>
								Close
							</button>
							<button
								type="submit"
								class="btn btn-primary"
								id="modal-button"
							>
								Add
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</body>
</html>
